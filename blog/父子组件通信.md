# Vue父子组件通信
<div style="text-align:center">
  <img src="images/message.png"/>
</div>
上图是官方提供的父子组件通信的示例图 <br />

父组件通过prop向子组件传递消息，子组件通过事件向父组件传递消息<br />

以简书的app为例：<br />

<div style="text-align:center">
  <img src="images/app-home.png"/>
</div>
<div style="text-align:center">
  <img src="images/app-center.png"/>
</div>
<div style="text-align:center">
  <img src="images/app-message.png"/>
</div>
布局相同，只有左侧文字不同，右侧图标和路由不同，所以将其提取为公共header组件，基本代码如下:

```
<div class="home-header" @click="test">
  <div class="home-header-left">{{headerText}}</div>
  <div class="home-header-right">
    <router-link :to="'/'+handlerUrl">
      <div class="home-heaader-function">
        <span class="header-feature">
          <img :src="handlerImg">
        </span>
      </div>
    </router-link>
    <router-link to="/search">
      <div class="home-heaader-function">
        <span class="header-search">
          <img src="../../../../images/header/search.png">
        </span>
      </div>
    </router-link>
  </div>
</div>
```
```
.home-header{height:90px;width:750px;box-sizing: border-box;padding:0 30px;font-size: 35px;position: fixed;top:0;left:50%;margin-left: -375px;background-color: white;z-index: 10;
border-bottom: 1px solid #ccc;color: #2c2c2c;font-weight: 600}
.home-header-left{height:90px;width:100px;text-align: left;line-height: 90px;float: left;}
.home-header-right{height:90px;width: 160px;float: right;}
.home-heaader-function{height:90px;width:80px;float:left;text-align: center;overflow: hidden;}
.header-search,.header-feature{height: 43px;width: auto;display: inline-block;margin-top: 23px}
.header-search img,.header-feature img{height: 43px;width: 100%}
.home-search{width:750px;background-color: red;position: fixed;top:0;left: 0;bottom: 90px;}
```
```
export default{
  props:["headerText","handlerImg","handlerUrl"],
  methods:{
    test:function(){
      this.$emit('fafn');
    }
  }
}
```
子组件中动态内容需要通过props来声明,然后在父组件中通过自定义属性来传入实际的值，这个过程就好像我们定义一个有参数的函数，在实际调用时在传入具体的参数<br />

在父组件中代码如下：<br />

```
<div>
    <home-header :header-text="headText" :handler-url="handlerUrl" :handlerImg="handlerImg" @fafn="fafn"></home-header>
    <home-content></home-content>
</div>
```
```
import homeHeader from "../common/header.vue"
import homeContent from "./content.vue"
import { mapMutations } from 'vuex'
export default{
  data(){
    return {
      headText:"首页",
      handlerUrl:"recommendFollow",
      handlerImg:"../../images/header/home.png"
    }
  },
  components:{
    homeHeader:homeHeader,
    homeContent:homeContent
  },
  beforeRouteLeave :function(to,from,next){
    var top = document.querySelector(".home-main").scrollTop;
    this.RECORD_SCROLL({name:"home",height:top});
    next();
  },
  mounted:function(){
    document.querySelector(".home-main").scrollTop = this.scroll;
  },
  methods:{
    ...mapMutations(["RECORD_SCROLL"]),
    fafn:function(){
      console.log(1);
      this.headText = "子组件";
    }
  },
  computed:{
    scroll(){
      return this.$store.state.homeScroll
    }
  }
}
```


